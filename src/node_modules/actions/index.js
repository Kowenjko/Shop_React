import {
    FETSH_PHONE_FAILURES,
    FETSH_PHONE_SUCCESS,
    FETSH_PHONE_START,
    LOAD_MORE_PHONE_FAILURES,
    LOAD_MORE_PHONE_SUCCESS,
    LOAD_MORE_PHONE_START,
    FETSH_PHONE_BY_ID_FAILURES,
    FETSH_PHONE_BY_ID_SUCCESS,
    FETSH_PHONE_BY_ID_START,
    ADD_PHONE_TO_BASKET,
    SEARCH_PHONE,
    FETSH_CATEGORIES_START,
    FETSH_CATEGORIES_SUCCESS,
    FETSH_CATEGORIES_FAILURES,
    FETSH_CATEGORIES_TYPE_START,
    FETSH_CATEGORIES_TYPE_SUCCESS,
    FETSH_CATEGORIES_TYPE_FAILURES,
    REMOVE_PHONE_FROM_BASKET,
    CLEAN_BASKET,
    FETCH_CATEGORY_TYPE
} from 'actionTypes'

import {
    fetchPhones as fetchPhonesApi,
    fetchPhoneById as fetchPhoneByIdApi,
    loadMorePhones as loadMorePhonesApi,
    fetchCategories as fetchCategoriesApi,
    fetchCategoriesType as fetchCategoriesTypeApi,
} from 'api'
import { getRenderedPhonesLength } from 'selectors'
// --------------------------------------------------
export const fetchPhones = (nameType) => async dispatch => {

    dispatch({
        type: FETSH_PHONE_START
    })
    try {
        const phones = await fetchPhonesApi(nameType)        
        dispatch({
            type: FETSH_PHONE_SUCCESS,
            payload: phones,
        })
    }
    catch (err) { dispatch({ type: FETSH_PHONE_FAILURES, payload: err, error: true }) }
}

// --------------------------------------------------
export const loadMorePhones = () => async (dispatch, getState) => {
    const offset = getRenderedPhonesLength(getState())
    dispatch({
        type: LOAD_MORE_PHONE_START
    })
    try {
        const phones = await loadMorePhonesApi({ offset })
        dispatch({
            type: LOAD_MORE_PHONE_SUCCESS,
            payload: phones,
        })
    }
    catch (err) { dispatch({ type: LOAD_MORE_PHONE_FAILURES, payload: err, error: true }) }
}

// --------------------------------------------------
export const fetchPhoneById = (id, nameType) => async dispatch => {

    dispatch({
        type: FETSH_PHONE_BY_ID_START
    })
    try {
        const phone = await fetchPhoneByIdApi(id, nameType)
        dispatch({
            type: FETSH_PHONE_BY_ID_SUCCESS,
            payload: phone,
        })
    }
    catch (err) {
        dispatch({ type: FETSH_PHONE_BY_ID_FAILURES, payload: err, error: true })
    }
}
// --------------------------------------------------
export const addPhoneToBacket = id => dispatch => {

    dispatch({
        type: ADD_PHONE_TO_BASKET,
        payload: id
    })

}
// ---------------------Моє-----------------------------
export const CategoryType = nameType => dispatch => {    
    dispatch({
        type: FETCH_CATEGORY_TYPE,
        payload: nameType
    })

}
// --------------------------------------------------
export const searchPhone = text => dispatch => {

    dispatch({
        type: SEARCH_PHONE,
        payload: text
    })

}

// --------------------------------------------------
export const fetchCategories = (nameType) => async dispatch => {
    dispatch({
        type: FETSH_CATEGORIES_START
    })
    try {
        const categories = await fetchCategoriesApi(nameType)
        dispatch({
            type: FETSH_CATEGORIES_SUCCESS,
            payload: categories,
        })
    }
    catch (err) { dispatch({ type: FETSH_CATEGORIES_FAILURES, payload: err, error: true }) }
}
// --------------------------------------------------
export const fetchCategoriesType = () => async dispatch => {
    dispatch({
        type: FETSH_CATEGORIES_TYPE_START
    })
    try {
        const categories = await fetchCategoriesTypeApi()
        dispatch({
            type: FETSH_CATEGORIES_TYPE_SUCCESS,
            payload: categories,
        })
    }
    catch (err) { dispatch({ type: FETSH_CATEGORIES_TYPE_FAILURES, payload: err, error: true }) }
}
// --------------------------------------------------
export const removePhonePromBasket = id => dispatch => {

    dispatch({
        type: REMOVE_PHONE_FROM_BASKET,
        payload: id
    })

}
// --------------------------------------------------
export const cleanBasket = () => dispatch => {

    dispatch({
        type: CLEAN_BASKET,
    })

}
// --------------------------------------------------
export const basketCheckout = phones => () => {
    alert(JSON.stringify(phones))
}

// --------------------------------------------------
